---
title: 5.States渲染状态
date:
  "{ date }": 
categories:
  - 图形学
  - Shader
  - Unity Shader
tags:
  - 图形学
---
### 回顾
```
			|---------Tags(渲染标签)
SubShader---|---------States(渲染状态)
			|---------Pass(渲染通道1~n)
```
渲染状态，通过状态来确定渲染时的剔除方式，深度测试方式，混合方式等等内容

片元：在渲染管线中，片元是指在光栅化阶段生成的像素或像素片段
片元是渲染管线中进行像素级别操作和计算的基本单位
每个片元代表了屏幕上的一个像素，并且有位置信息和与之相关的属性，如颜色，深度值，法线等
### 渲染状态的语法结构
渲染状态关键词 + 空格 + 状态类型
```
LOD 100
```
存在多个渲染状态，通过空格隔开
### 剔除方式
设置多边形的剔除方式，有背面剔除，正面剔除，不剔除
所谓的剔除就是不渲染，背面剔除就是背面不渲染，正面剔除则是正面不渲染（较少使用），不剔除就是都渲染
	Cull Back 背面剔除(默认)
	Cull Front 正面剔除
	Cull Off 不剔除
```
LOD 100
Cull Off
```
### 深度缓冲
是否写入上深度缓冲（Depth Buffer）：
深度缓冲是一个与屏幕像素对应的缓冲区，用于存储每个像素的深度值（距离相机的距离），渲染场景之前，深度缓冲被初始化为最大深度值，表示所有像素都在相机之外。最后留在深度缓冲中的信息会被渲染
![](../../../../img/beishang20250227213623664.png)

ZWrite On  写入深度缓冲
ZWrite Off  不写入深度缓冲
不设置默认为写入
一般情况下，在做透明等特殊效果时，会设置为不写入
```
LOD 100
Cull Off
ZWrite Off
```
### 深度测试
**渲染场景之前，深度缓冲被初始化为最大深度值**
自定义深度测试的对比方式，是否写入深度缓冲当中要看上面ZWrite On
_ZTest Greater    |  大于于当前深度缓冲中的值，就通过测试        |     |
ZTest LEqual      |  小于等于当前深度缓冲中的值，就通过测试    |     |
ZTest GEqual     |  大于等于当前深度缓冲中的值，就通过测试    |     |
ZTest Equal        |  等于当前深度缓冲中的值，就通过测试           |     |
ZTest NotEqual  |  不等于当前深度缓冲中的值，就通过测试       |     |
ZTest Always      |  始终通过测试                                                   |     |_
不设置默认为LEqual 小于等于
只有在一些特殊效果如描边效果时会修改为Greater
 
### 混合方式
一次深度测试就会进行一次混合
![](../../../../img/beishang20250227222044250.png)
深度测试和混合都是在渲染管线光栅化阶段中逐元操作中进行的。

### 混合方式
设置渲染图像的混合方式：多种颜色叠加混合，比如透明，半透明效果和遮挡的物体进行颜色混合
```
Blend One One                        线性减淡
Blend SrcAlpha OneMinusSrcAlpha      正常透明混合
Blend OneMinusDstColor One           滤色
Blend DstColor Zero                  正片叠底
Blend DstColor SrcColor              X光片效果
Blend One OneMinusSrcAlpha           透明度混合
```
不设置默认不会进行混合

### 其他渲染状态
1. LOD  控制LOD级别，在不同距离下使用不同的渲染方式处理
2. ColorMask  设置颜色通道的写入蒙版，默认蒙版为RGBA
3. 等等

### 总结
可以在SubShader和Pass渲染通道语句块中声明这些渲染状态
在SubShader语句块中使用影响所有的渲染通道Pass
在Pass语句块中使用只会影响当前Pass渲染通道

剔除方式决定了模型正背面是否能够被渲染
深度缓冲和深度测试决定景深关系的确定以及透明效果的正确表达
混合方式决定透明半透明颜色的正确表现，以及一些特殊颜色效果的表现

### 四.Shader的备用着色器
保底，至少会显示
#### 备用Shader语法
Fallback “Shader名”
```
    Fallback "VertexLit"
```
或者Fallback Off
直接关闭Fallback功能
